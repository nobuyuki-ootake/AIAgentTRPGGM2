# ã‚·ãƒŠãƒªã‚ªç®¡ç†ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…è¨ˆç”»

## ğŸ“‹ æ¦‚è¦

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€`ã‚·ãƒŠãƒªã‚ªç®¡ç†.md`ã§å®šç¾©ã—ãŸTRPGã‚·ãƒŠãƒªã‚ªç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…è¨ˆç”»ã‚’ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆå½¢å¼ã§ç®¡ç†ã—ã¾ã™ã€‚

## ğŸ¯ å®Ÿè£…æ–¹é‡

**ãƒˆãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**ã«ã‚ˆã‚Šã€ä»¥ä¸‹ã®é †åºã§å®Ÿè£…ã‚’é€²ã‚ã¾ã™ï¼š
1. ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³æ¦‚è¦ç”Ÿæˆ
2. ã‚³ã‚¢ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ—ãƒ¼ãƒ«ç”Ÿæˆï¼ˆãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³å¿…é ˆï¼‰
3. è¿½åŠ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ—ãƒ¼ãƒ«ç”Ÿæˆï¼ˆå ±é…¬ãƒ»ä½“é¨“å‘ä¸Šç³»ï¼‰
4. å ´æ‰€ç”Ÿæˆãƒ»é…ç½®æœ€é©åŒ–
5. è©³ç´°åŒ–ãƒ»ãƒãƒ©ãƒ³ã‚¹èª¿æ•´

## ğŸ“Š ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³åˆ†æ

### âœ… å®Œå…¨å®Ÿè£…æ¸ˆã¿ (100%)
- [x] åŸºæœ¬å‹å®šç¾©ï¼ˆAIMilestone, EntityPool, PoolEnemy, PoolNPC, PoolItem, PoolQuestï¼‰
- [x] åŸºæœ¬çš„ãªãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ç”ŸæˆAPI routes
- [x] ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
- [x] åŸºæœ¬çš„ãªå ´æ‰€ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
- [x] AIã‚µãƒ¼ãƒ“ã‚¹çµ±åˆåŸºç›¤

### ğŸ”¶ éƒ¨åˆ†å®Ÿè£…æ¸ˆã¿ (60-80%)
- [x] aiMilestoneGenerationServiceåŸºæœ¬æ©Ÿèƒ½
- [x] ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ—ãƒ¼ãƒ«ç”Ÿæˆï¼ˆåŸºæœ¬ç‰ˆï¼‰
- [x] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒï¼ˆåŸºæœ¬ç‰ˆï¼‰

### âŒ æœªå®Ÿè£… (0-30%)
- [ ] äºŒå±¤æ§‹é€ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ—ãƒ¼ãƒ«
- [ ] è¤‡æ•°ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ç´ä»˜ã‘ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³
- [ ] å ´æ‰€ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£é…ç½®ã‚·ã‚¹ãƒ†ãƒ 
- [ ] ãƒˆãƒƒãƒ—ãƒ€ã‚¦ãƒ³ç”Ÿæˆãƒ•ãƒ­ãƒ¼
- [ ] æ‰‹æ¢ã‚Šä½“é¨“æ¼”å‡ºã‚·ã‚¹ãƒ†ãƒ 
- [ ] å ±é…¬åˆ†é¡ã‚·ã‚¹ãƒ†ãƒ ï¼ˆå®Ÿç”¨çš„/ãƒˆãƒ­ãƒ•ã‚£ãƒ¼/ãƒŸã‚¹ãƒ†ãƒªãƒ¼ï¼‰

---

## ğŸ—‚ï¸ Phase 1: å‹å®šç¾©ãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ‹¡å¼µ

### 1.1 å‹å®šç¾©æ‹¡å¼µ ğŸ“

#### âœ… å¿…è¦ãªå‹å®šç¾©è¿½åŠ 
- [ ] **AIMilestoneæ‹¡å¼µ** (`packages/types/src/index.ts`)
  - [ ] `targetEntityIds: string[]` (è¤‡æ•°ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å¯¾å¿œ)
  - [ ] `progressContributions: number[]` (å„ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®é€²æ—è²¢çŒ®åº¦)
  - [ ] `hiddenFromPlayer: boolean` (ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼éè¡¨ç¤ºãƒ•ãƒ©ã‚°)
  - [ ] `categoryType: 'core' | 'bonus'` å‰Šé™¤ï¼ˆãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ã«ã¯ä¸è¦ï¼‰

- [ ] **EntityPoolCollectionæ‹¡å¼µ**
  - [ ] `coreEntities: CoreEntityCollection` (ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³å¿…é ˆ)
  - [ ] `bonusEntities: BonusEntityCollection` (è¿½åŠ å ±é…¬ç³»)

- [ ] **æ–°ã—ã„å‹å®šç¾©è¿½åŠ **
  ```typescript
  interface CoreEntityCollection {
    enemies: PoolEnemy[];
    events: InteractiveEvent[];
    npcs: PoolNPC[];
    items: PoolItem[];
    quests: PoolQuest[];
  }
  
  interface BonusEntityCollection {
    practicalRewards: PracticalRewardEntity[];
    trophyItems: TrophyEntity[];
    mysteryItems: MysteryEntity[];
  }
  
  interface LocationEntityMapping {
    id: string;
    sessionId: string;
    locationId: string;
    entityId: string;
    entityType: 'core' | 'bonus';
    entityCategory: 'enemy' | 'event' | 'npc' | 'item' | 'quest';
    timeConditions?: string[];
    prerequisiteEntities?: string[];
    isAvailable: boolean;
    discoveredAt?: string;
  }
  
  interface PracticalRewardEntity {
    id: string;
    name: string;
    type: 'healing' | 'equipment' | 'enhancement';
    rewards: {
      items: Array<{
        name: string;
        effect: string;
        quantity: number;
        rarity: ItemRarity;
      }>;
      experience: number;
    };
  }
  
  interface TrophyEntity {
    id: string;
    name: string;
    description: string;
    rewards: {
      items: Array<{
        name: string;
        effect: "ãªã—";
        description: string;
        category: "trophy";
        rarity: ItemRarity;
      }>;
      information: string[];
      experience: number;
    };
  }
  
  interface MysteryEntity {
    id: string;
    name: string;
    description: string;
    rewards: {
      items: Array<{
        name: string;
        effect: "ãªã—" | "ä¸æ˜";
        description: string;
        category: "mystery_item";
      }>;
      information: string[];
      experience: number;
    };
  }
  ```

### 1.2 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒæ‹¡å¼µ ğŸ—„ï¸

#### âœ… ãƒ†ãƒ¼ãƒ–ãƒ«æ‹¡å¼µ
- [ ] **ai_milestones ãƒ†ãƒ¼ãƒ–ãƒ«æ‹¡å¼µ**
  ```sql
  ALTER TABLE ai_milestones ADD COLUMN target_entity_ids TEXT NOT NULL DEFAULT '[]'; -- JSONé…åˆ—
  ALTER TABLE ai_milestones ADD COLUMN progress_contributions TEXT NOT NULL DEFAULT '[]'; -- JSONé…åˆ— [33, 33, 34]
  ALTER TABLE ai_milestones ADD COLUMN hidden_from_player BOOLEAN NOT NULL DEFAULT true;
  ALTER TABLE ai_milestones DROP COLUMN target_id; -- å˜ä¸€IDå‰Šé™¤
  ```

- [ ] **entity_pools ãƒ†ãƒ¼ãƒ–ãƒ«æ‹¡å¼µ**
  ```sql
  ALTER TABLE entity_pools ADD COLUMN core_entities TEXT NOT NULL DEFAULT '{}'; -- JSON: ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³å¿…é ˆ
  ALTER TABLE entity_pools ADD COLUMN bonus_entities TEXT NOT NULL DEFAULT '{}'; -- JSON: è¿½åŠ å ±é…¬ç³»
  -- æ—¢å­˜ã® entities ã‚«ãƒ©ãƒ ã¯å¾Œæ–¹äº’æ›æ€§ã®ãŸã‚æ®‹ã™
  ```

- [ ] **æ–°ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ**
  ```sql
  CREATE TABLE location_entity_mappings (
    id TEXT PRIMARY KEY,
    session_id TEXT NOT NULL,
    location_id TEXT NOT NULL,
    entity_id TEXT NOT NULL,
    entity_type TEXT NOT NULL, -- 'core' | 'bonus'
    entity_category TEXT NOT NULL, -- 'enemy' | 'event' | 'npc' | 'item' | 'quest'
    time_conditions TEXT, -- JSONé…åˆ—
    prerequisite_entities TEXT, -- JSONé…åˆ—
    is_available BOOLEAN DEFAULT TRUE,
    discovered_at TEXT,
    created_at TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (session_id) REFERENCES sessions(id) ON DELETE CASCADE
  );
  
  CREATE TABLE scenario_generation_log (
    id TEXT PRIMARY KEY,
    session_id TEXT NOT NULL,
    phase TEXT NOT NULL, -- 'milestone_outline' | 'core_entities' | 'bonus_entities' | 'location_mapping'
    ai_provider TEXT NOT NULL,
    input_data TEXT NOT NULL, -- JSON
    output_data TEXT NOT NULL, -- JSON
    processing_time INTEGER NOT NULL, -- milliseconds
    tokens_used INTEGER,
    success BOOLEAN NOT NULL,
    error_message TEXT,
    created_at TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (session_id) REFERENCES sessions(id) ON DELETE CASCADE
  );
  ```

---

## ğŸ—‚ï¸ Phase 2: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹æ‹¡å¼µ

### 2.1 AIMilestoneGenerationServiceæ‹¡å¼µ âš™ï¸

#### âœ… ãƒˆãƒƒãƒ—ãƒ€ã‚¦ãƒ³ç”Ÿæˆãƒ•ãƒ­ãƒ¼å®Ÿè£…
- [ ] **generateMilestonesAndPools ãƒ¡ã‚½ãƒƒãƒ‰å®Œå…¨ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°**
  ```typescript
  async generateMilestonesAndPools(request: MilestoneGenerationRequest): Promise<MilestoneGenerationResponse> {
    // Phase 1: ç›®æ¨™è¨­è¨ˆ
    const milestoneOutlines = await this.generateMilestoneOutlines(request);
    const milestoneRelations = await this.defineMilestoneRelations(milestoneOutlines, request);
    
    // Phase 2: ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆ
    const coreEntityRequirements = await this.defineCoreEntityRequirements(milestoneRelations);
    const coreEntities = await this.generateCoreEntities(coreEntityRequirements, request);
    const bonusEntities = await this.generateBonusEntities(request, coreEntities);
    const locationMappings = await this.generateLocationMappings(coreEntities, bonusEntities, request);
    
    // Phase 3: æœ€çµ‚èª¿æ•´
    const detailedMilestones = await this.detailizeMilestones(milestoneOutlines, coreEntities);
    const balancedSystem = await this.balanceSystem(detailedMilestones, coreEntities, bonusEntities);
    
    return await this.commitToDatabase(balancedSystem);
  }
  ```

- [ ] **æ–°ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£…**
  - [ ] `generateMilestoneOutlines()` - ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³æ¦‚è¦ç”Ÿæˆ
  - [ ] `defineMilestoneRelations()` - ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³é–¢ä¿‚æ€§è¨­å®š
  - [ ] `defineCoreEntityRequirements()` - å¿…é ˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£è¦ä»¶æ±ºå®š
  - [ ] `generateCoreEntities()` - ã‚³ã‚¢ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ç”Ÿæˆ
  - [ ] `generateBonusEntities()` - è¿½åŠ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ç”Ÿæˆ
  - [ ] `generateLocationMappings()` - å ´æ‰€é…ç½®æœ€é©åŒ–
  - [ ] `detailizeMilestones()` - ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³è©³ç´°åŒ–
  - [ ] `balanceSystem()` - ãƒãƒ©ãƒ³ã‚¹èª¿æ•´
  - [ ] `commitToDatabase()` - ä¸€æ‹¬ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚³ãƒŸãƒƒãƒˆ

- [ ] **ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£åˆ†é¡ç”Ÿæˆæ©Ÿèƒ½**
  - [ ] `generatePracticalRewards()` - å®Ÿç”¨çš„å ±é…¬ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
  - [ ] `generateTrophyItems()` - ãƒˆãƒ­ãƒ•ã‚£ãƒ¼ãƒ»åé›†ç³»ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
  - [ ] `generateMysteryItems()` - ãƒŸã‚¹ãƒ†ãƒªãƒ¼ç³»ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£

### 2.2 LocationEntityMappingServiceæ–°è¦ä½œæˆ ğŸ“

#### âœ… å ´æ‰€ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ç®¡ç†
- [ ] **æ–°ã‚µãƒ¼ãƒ“ã‚¹ä½œæˆ** (`apps/proxy-server/src/services/locationEntityMappingService.ts`)
  ```typescript
  class LocationEntityMappingService {
    async createMappings(sessionId: string, mappings: LocationEntityMapping[]): Promise<void>
    async getMappingsByLocation(locationId: string, sessionId: string): Promise<LocationEntityMapping[]>
    async getMappingsByEntity(entityId: string): Promise<LocationEntityMapping[]>
    async updateAvailability(mappingId: string, isAvailable: boolean): Promise<void>
    async markDiscovered(mappingId: string): Promise<void>
    async getAvailableEntitiesForLocation(locationId: string, sessionId: string): Promise<EntityReference[]>
  }
  ```

- [ ] **æ™‚é–“æ¡ä»¶ãƒ»å‰ææ¡ä»¶ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½**
  - [ ] `checkTimeConditions()` - æ™‚é–“å¸¯ã«ã‚ˆã‚‹è¡¨ç¤ºåˆ¶å¾¡
  - [ ] `checkPrerequisites()` - å‰æã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£é”æˆç¢ºèª
  - [ ] `updateDynamicAvailability()` - å‹•çš„ãªåˆ©ç”¨å¯èƒ½æ€§æ›´æ–°

### 2.3 æ‰‹æ¢ã‚Šä½“é¨“æ¼”å‡ºã‚µãƒ¼ãƒ“ã‚¹ ğŸ­

#### âœ… PlayerExperienceServiceæ–°è¦ä½œæˆ
- [ ] **æ–°ã‚µãƒ¼ãƒ“ã‚¹ä½œæˆ** (`apps/proxy-server/src/services/playerExperienceService.ts`)
  ```typescript
  class PlayerExperienceService {
    async getMaskedProgressInfo(sessionId: string): Promise<MaskedProgressInfo>
    async generateSubtleHints(milestoneProgress: number, milestoneId: string): Promise<string[]>
    async filterPlayerVisibleContent(content: any): Promise<any>
    async generateNaturalGuidance(context: SessionContext): Promise<string>
    async createAmbiguousRewardMessage(reward: any): Promise<string>
  }
  
  interface MaskedProgressInfo {
    availableActions: string[];
    ambiguousHints: string[];
    atmosphereDescription: string;
    discoveredElements: string[];
  }
  ```

---

## ğŸ—‚ï¸ Phase 3: API Routesæ‹¡å¼µ

### 3.1 æ—¢å­˜APIæ‹¡å¼µ ğŸ”Œ

#### âœ… aiMilestoneGeneration.tsæ‹¡å¼µ
- [ ] **æ–°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¿½åŠ **
  ```typescript
  POST /api/ai-milestone-generation/generate-scenario-topdown
  GET  /api/ai-milestone-generation/session/:sessionId/player-progress
  GET  /api/ai-milestone-generation/location/:locationId/available-actions
  PATCH /api/ai-milestone-generation/entity/:entityId/discover
  GET  /api/ai-milestone-generation/session/:sessionId/subtle-hints
  ```

- [ ] **æ—¢å­˜ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæ‹¡å¼µ**
  - [ ] `GET /session/:sessionId/entity-pool` - äºŒå±¤æ§‹é€ å¯¾å¿œ
  - [ ] `PATCH /milestone/:milestoneId/progress` - è¤‡æ•°ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£é€²æ—å¯¾å¿œ

### 3.2 æ–°è¦APIä½œæˆ

#### âœ… locationEntityMapping.tsæ–°è¦ä½œæˆ
- [ ] **æ–°ãƒ«ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ** (`apps/proxy-server/src/routes/locationEntityMapping.ts`)
  ```typescript
  GET    /api/location-entity-mapping/location/:locationId/entities
  POST   /api/location-entity-mapping/create-mappings
  PATCH  /api/location-entity-mapping/:mappingId/availability
  PATCH  /api/location-entity-mapping/:mappingId/discover
  GET    /api/location-entity-mapping/session/:sessionId/all-mappings
  ```

#### âœ… playerExperience.tsæ–°è¦ä½œæˆ
- [ ] **æ–°ãƒ«ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ** (`apps/proxy-server/src/routes/playerExperience.ts`)
  ```typescript
  GET /api/player-experience/session/:sessionId/masked-progress
  GET /api/player-experience/session/:sessionId/available-actions
  GET /api/player-experience/session/:sessionId/subtle-hints
  POST /api/player-experience/generate-natural-guidance
  ```

---

## ğŸ—‚ï¸ Phase 4: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…

### 4.1 API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæ‹¡å¼µ ğŸ’»

#### âœ… aiMilestoneGeneration.tsæ‹¡å¼µ
- [ ] **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæ‹¡å¼µ** (`apps/frontend/src/api/aiMilestoneGeneration.ts`)
  ```typescript
  async generateScenarioTopDown(request: TopDownGenerationRequest): Promise<ScenarioGenerationResponse>
  async getPlayerProgress(sessionId: string): Promise<MaskedProgressInfo>
  async getAvailableActions(locationId: string, sessionId: string): Promise<string[]>
  async discoverEntity(entityId: string): Promise<void>
  async getSubtleHints(sessionId: string): Promise<string[]>
  ```

#### âœ… æ–°APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆä½œæˆ
- [ ] **locationEntityMapping.ts** (`apps/frontend/src/api/locationEntityMapping.ts`)
- [ ] **playerExperience.ts** (`apps/frontend/src/api/playerExperience.ts`)

### 4.2 UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ‹¡å¼µ ğŸ¨

#### âœ… å³ã‚µã‚¤ãƒ‰ãƒãƒ¼å®Ÿè£…
- [ ] **LocationBasedActionSidebar.tsxæ–°è¦ä½œæˆ**
  ```typescript
  interface LocationBasedActionSidebarProps {
    sessionId: string;
    currentLocationId: string;
    onActionSelect: (actionId: string) => void;
  }
  ```
  - [ ] ç¾åœ¨åœ°ãƒ™ãƒ¼ã‚¹ã®è¡Œå‹•è¡¨ç¤º
  - [ ] æ™‚é–“æ¡ä»¶ã«ã‚ˆã‚‹å‹•çš„è¡¨ç¤º
  - [ ] ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³é€²æ—ã®å†…éƒ¨ç®¡ç†ï¼ˆéè¡¨ç¤ºï¼‰
  - [ ] æ›–æ˜§ãªãƒ’ãƒ³ãƒˆè¡¨ç¤ºï¼ˆã€Œæ°—ã«ãªã‚‹ã‚‚ã®ã€ï¼‰

#### âœ… ã‚·ãƒŠãƒªã‚ªç”ŸæˆUIæ‹¡å¼µ
- [ ] **ScenarioMilestoneEditor.tsxæ‹¡å¼µ**
  - [ ] äºŒå±¤æ§‹é€ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ—ãƒ¼ãƒ«è¡¨ç¤º
  - [ ] ã‚³ã‚¢/ãƒœãƒ¼ãƒŠã‚¹ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®åŒºåˆ¥è¡¨ç¤º
  - [ ] ãƒˆãƒƒãƒ—ãƒ€ã‚¦ãƒ³ç”Ÿæˆé€²æ—è¡¨ç¤º
  - [ ] æ‰‹æ¢ã‚Šä½“é¨“ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ

#### âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ç”»é¢æ‹¡å¼µ
- [ ] **SessionInterface.tsxæ‹¡å¼µ**
  - [ ] å³ã‚µã‚¤ãƒ‰ãƒãƒ¼çµ±åˆ
  - [ ] æ‰‹æ¢ã‚Šä½“é¨“ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ
  - [ ] ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³é€²æ—ã®éè¡¨ç¤ºåŒ–
  - [ ] è‡ªç„¶ãªå ±é…¬è¡¨ç¤ºæ¼”å‡º

---

## ğŸ—‚ï¸ Phase 5: AI ã‚µãƒ¼ãƒ“ã‚¹æ‹¡å¼µ

### 5.1 AIServiceæ‹¡å¼µ ğŸ¤–

#### âœ… ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ‹¡å¼µ
- [ ] **æ–°ç”Ÿæˆãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ ** (`apps/proxy-server/src/services/aiService.ts`)
  ```typescript
  async generateMilestoneOutlines(context: CampaignContext): Promise<MilestoneOutline[]>
  async generateCoreEntities(requirements: CoreEntityRequirements): Promise<CoreEntityCollection>
  async generateBonusEntities(context: any): Promise<BonusEntityCollection>
  async generateSubtleHints(progress: ProgressContext): Promise<string[]>
  async generateNaturalGuidance(situation: SituationContext): Promise<string>
  ```

- [ ] **ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€é©åŒ–**
  - [ ] æ—¥æœ¬èªå¯¾å¿œã®å¼·åŒ–
  - [ ] ãƒ†ãƒ¼ãƒåˆ¥ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆèª¿æ•´
  - [ ] æ‰‹æ¢ã‚Šæ„Ÿæ¼”å‡ºç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
  - [ ] ãƒˆãƒ­ãƒ•ã‚£ãƒ¼/ãƒŸã‚¹ãƒ†ãƒªãƒ¼ã‚¢ã‚¤ãƒ†ãƒ ç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

### 5.2 systemPrompts.tsæ‹¡å¼µ ğŸ“

#### âœ… æ–°ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¿½åŠ 
- [ ] **ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³æ¦‚è¦ç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
- [ ] **äºŒå±¤æ§‹é€ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
- [ ] **å ´æ‰€é…ç½®æœ€é©åŒ–ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
- [ ] **æ‰‹æ¢ã‚Šæ„Ÿæ¼”å‡ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
- [ ] **å ±é…¬åˆ†é¡åˆ¥ç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**

---

## ğŸ—‚ï¸ Phase 6: ãƒ†ã‚¹ãƒˆãƒ»å“è³ªä¿è¨¼

### 6.1 å˜ä½“ãƒ†ã‚¹ãƒˆ ğŸ§ª

#### âœ… ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
- [ ] **AIMilestoneGenerationService ãƒ†ã‚¹ãƒˆ**
  - [ ] ãƒˆãƒƒãƒ—ãƒ€ã‚¦ãƒ³ç”Ÿæˆãƒ•ãƒ­ãƒ¼
  - [ ] äºŒå±¤æ§‹é€ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ—ãƒ¼ãƒ«
  - [ ] ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³è¤‡æ•°ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ç´ä»˜ã‘
  - [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

- [ ] **LocationEntityMappingService ãƒ†ã‚¹ãƒˆ**
  - [ ] å ´æ‰€ãƒ™ãƒ¼ã‚¹é…ç½®ãƒ­ã‚¸ãƒƒã‚¯
  - [ ] æ™‚é–“æ¡ä»¶ãƒ»å‰ææ¡ä»¶ãƒã‚§ãƒƒã‚¯
  - [ ] å‹•çš„åˆ©ç”¨å¯èƒ½æ€§æ›´æ–°

- [ ] **PlayerExperienceService ãƒ†ã‚¹ãƒˆ**
  - [ ] é€²æ—æƒ…å ±ãƒã‚¹ã‚­ãƒ³ã‚°
  - [ ] æš—ç¤ºçš„ãƒ’ãƒ³ãƒˆç”Ÿæˆ
  - [ ] è‡ªç„¶ãªèª˜å°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

#### âœ… ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
- [ ] **LocationBasedActionSidebar ãƒ†ã‚¹ãƒˆ**
  - [ ] è¡Œå‹•è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯
  - [ ] æ™‚é–“æ¡ä»¶ã«ã‚ˆã‚‹è¡¨ç¤ºå¤‰åŒ–
  - [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³

- [ ] **ã‚·ãƒŠãƒªã‚ªç”Ÿæˆãƒ•ãƒ­ãƒ¼ ãƒ†ã‚¹ãƒˆ**
  - [ ] ãƒˆãƒƒãƒ—ãƒ€ã‚¦ãƒ³ç”ŸæˆUI
  - [ ] ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºãƒ»ãƒªãƒˆãƒ©ã‚¤
  - [ ] ç”Ÿæˆé€²æ—è¡¨ç¤º

### 6.2 çµ±åˆãƒ†ã‚¹ãƒˆ ğŸ”—

#### âœ… ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ ãƒ†ã‚¹ãƒˆ
- [ ] **ã€Œã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹ï¼ã€â†’ãƒ—ãƒ¬ã‚¤å¯èƒ½ã¾ã§ ãƒ•ãƒ­ãƒ¼**
  - [ ] ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³æ¦‚è¦ç”Ÿæˆ
  - [ ] ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ—ãƒ¼ãƒ«ç”Ÿæˆ
  - [ ] å ´æ‰€é…ç½®å®Œäº†
  - [ ] å³ã‚µã‚¤ãƒ‰ãƒãƒ¼åˆæœŸè¡¨ç¤º
  - [ ] ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼è¡Œå‹•å®Ÿè¡Œ

- [ ] **æ‰‹æ¢ã‚Šä½“é¨“ã‚·ãƒŠãƒªã‚ª ãƒ†ã‚¹ãƒˆ**
  - [ ] ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³é€²æ—éè¡¨ç¤º
  - [ ] æš—ç¤ºçš„ãƒ’ãƒ³ãƒˆè¡¨ç¤º
  - [ ] è‡ªç„¶ãªå ±é…¬æ¼”å‡º
  - [ ] ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ç™ºè¦‹ãƒ•ãƒ­ãƒ¼

### 6.3 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ âš¡

#### âœ… ç”Ÿæˆæ™‚é–“ãƒ»ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
- [ ] **å¤§è¦æ¨¡ã‚·ãƒŠãƒªã‚ªç”Ÿæˆãƒ†ã‚¹ãƒˆ**
  - [ ] 15ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ + 6ãƒœãƒ¼ãƒŠã‚¹ç”Ÿæˆæ™‚é–“
  - [ ] ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ç›£è¦–
  - [ ] AI APIå‘¼ã³å‡ºã—æœ€é©åŒ–

- [ ] **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ãƒ†ã‚¹ãƒˆ**
  - [ ] å³ã‚µã‚¤ãƒ‰ãƒãƒ¼æ›´æ–°ãƒ¬ã‚¹ãƒãƒ³ã‚¹
  - [ ] ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ç™ºè¦‹æ™‚ã®æ›´æ–°é€Ÿåº¦
  - [ ] WebSocketé€šä¿¡è² è·

---

## ğŸ—‚ï¸ Phase 7: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ»æœ€çµ‚èª¿æ•´

### 7.1 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–° ğŸ“š

#### âœ… æŠ€è¡“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [ ] **APIä»•æ§˜æ›¸æ›´æ–°**
  - [ ] æ–°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¿½åŠ 
  - [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼å¤‰æ›´
  - [ ] ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰å®šç¾©

- [ ] **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆæ›¸æ›´æ–°**
  - [ ] æ–°ãƒ†ãƒ¼ãƒ–ãƒ«ä»•æ§˜
  - [ ] ERå›³æ›´æ–°
  - [ ] ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­è¨ˆ

#### âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰
- [ ] **ã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼å‘ã‘ã‚¬ã‚¤ãƒ‰**
  - [ ] ã‚·ãƒŠãƒªã‚ªç”Ÿæˆã®ä½¿ã„æ–¹
  - [ ] æ‰‹æ¢ã‚Šä½“é¨“ã®èª¿æ•´æ–¹æ³•
  - [ ] ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### 7.2 æœ¬ç•ªç’°å¢ƒæº–å‚™ ğŸš€

#### âœ… ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ
- [ ] **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**
  - [ ] æ—¢å­˜ãƒ‡ãƒ¼ã‚¿äº’æ›æ€§ç¢ºèª
  - [ ] ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †æº–å‚™
  - [ ] æœ¬ç•ªç’°å¢ƒãƒ†ã‚¹ãƒˆ

- [ ] **AI APIä½¿ç”¨é‡ç›£è¦–**
  - [ ] ç”Ÿæˆã‚³ã‚¹ãƒˆè¨ˆç®—
  - [ ] ä½¿ç”¨é‡ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
  - [ ] ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥å®Ÿè£…

---

## ğŸ“Š é€²æ—ç®¡ç†

### ğŸ¯ ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³
- **Phase 1 å®Œäº†**: 2025-02-15 (äºˆå®š)
- **Phase 2-3 å®Œäº†**: 2025-03-01 (äºˆå®š)  
- **Phase 4 å®Œäº†**: 2025-03-15 (äºˆå®š)
- **Phase 5-6 å®Œäº†**: 2025-03-30 (äºˆå®š)
- **Phase 7 å®Œäº†**: 2025-04-10 (äºˆå®š)

### ğŸ“ˆ å„ªå…ˆåº¦
1. **High**: Phase 1-2 (å‹å®šç¾©ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰åŸºç›¤)
2. **Medium**: Phase 3-4 (APIãƒ»ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰)
3. **Low**: Phase 5-7 (AIæ‹¡å¼µãƒ»ãƒ†ã‚¹ãƒˆãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ)

### âš ï¸ ãƒªã‚¹ã‚¯è¦å› 
- AIç”Ÿæˆå“è³ªã®ä¸€è²«æ€§ç¢ºä¿
- å¤§è¦æ¨¡ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ—ãƒ¼ãƒ«ç”Ÿæˆã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- æ‰‹æ¢ã‚Šä½“é¨“ã®èª¿æ•´é›£æ˜“åº¦
- æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¨ã®äº’æ›æ€§ç¶­æŒ

---

## ğŸ‰ å®Œäº†äºˆå®šåŠ¹æœ

ã“ã®ã‚·ãƒŠãƒªã‚ªç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ãŒå®Œå…¨å®Ÿè£…ã•ã‚Œã‚‹ã¨ï¼š

1. **ã€Œã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹ï¼ã€ã‹ã‚‰30ç§’ä»¥å†…**ã«ãƒ—ãƒ¬ã‚¤å¯èƒ½çŠ¶æ…‹åˆ°é”
2. **æ‰‹æ¢ã‚Šæ„Ÿã‚’ç¶­æŒ**ã—ãªãŒã‚‰å……å®Ÿã—ãŸå ±é…¬ã‚·ã‚¹ãƒ†ãƒ æä¾›
3. **AIã«ã‚ˆã‚‹ä¸€è²«ã—ãŸã‚¹ãƒˆãƒ¼ãƒªãƒ¼**ã§ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æº€è¶³åº¦å‘ä¸Š
4. **å¤šæ§˜ãªå ±é…¬åˆ†é¡**ã§æ¢ç´¢æ„æ¬²ä¿ƒé€²
5. **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ **ã§æ§˜ã€…ãªãƒ†ãƒ¼ãƒå¯¾å¿œ

ã“ã‚Œã«ã‚ˆã‚Šã€çœŸã®æ„å‘³ã§ã®ã€ŒAIé§†å‹•TRPGä½“é¨“ã€ãŒå®Ÿç¾ã•ã‚Œã¾ã™ã€‚