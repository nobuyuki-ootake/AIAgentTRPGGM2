# キャラクター管理機能要件定義

## 概要
TRPG キャンペーンにおけるプレイヤーキャラクター（PC）、ノンプレイヤーキャラクター（NPC）、敵キャラクター（Enemy）の包括的管理システム。

## 基本機能

### 1. キャラクター種別管理
- **PC（プレイヤーキャラクター）**: プレイヤーが操作するメインキャラクター
- **NPC（ノンプレイヤーキャラクター）**: ストーリー上の重要キャラクター
- **Enemy（敵キャラクター）**: 戦闘やコンフリクトの対象

### 2. キャラクター基本情報
- **基本データ**:
  - 名前、年齢、性別
  - 種族、職業、クラス
  - レベル、経験値
- **能力値**:
  - 基本能力値（筋力、敏捷性、知力等）
  - 派生能力値（HP、MP、AC等）
  - スキル・特技一覧
- **外見・設定**:
  - 物理的特徴
  - 性格・背景
  - 画像・アバター

### 3. キャラクターシート機能
- **フルシート表示**: 全情報の詳細表示
- **クイックリファレンス**: 戦闘時等の要点表示
- **編集モード**: リアルタイム編集機能
- **バージョン管理**: 成長過程の履歴保存

## PC（プレイヤーキャラクター）固有機能

### 1. キャラクター作成
- **ステップバイステップ作成**: ガイド付き作成プロセス
- **ランダム生成**: AI による自動生成オプション
- **テンプレート**: 職業別の推奨構成

### 2. 成長管理
- **レベルアップ**: 能力値・スキルの成長
- **装備管理**: アイテム・武器・防具の管理
- **習得履歴**: スキル・特技の取得過程

## NPC（ノンプレイヤーキャラクター）固有機能

### 1. ストーリー統合
- **関係性マップ**: 他キャラクターとの関係図
- **重要度設定**: ストーリーにおける位置づけ
- **登場頻度**: 出現パターンの管理

### 2. AI行動パターン
- **性格設定**: AI による自然な会話・行動
- **目標・動機**: キャラクター駆動の行動原理
- **反応パターン**: PC行動に対する反応定義

### 3. 動的進化
- **関係性変化**: PC との関係性の発展
- **状況適応**: ストーリー進行に応じた変化
- **記憶システム**: 過去の出来事の記憶・参照

## Enemy（敵キャラクター）固有機能

### 1. 戦闘データ
- **戦闘能力**: HP、攻撃力、防御力等
- **特殊能力**: 魔法、特技、弱点
- **戦術AI**: 戦闘時の行動パターン

### 2. 遭遇管理
- **出現条件**: 登場タイミング・場所
- **難易度調整**: パーティレベルに応じた調整
- **戦利品**: 撃破時の報酬設定

### 3. バリエーション管理
- **雑魚敵**: 数で勝負する基本敵
- **精鋭敵**: 個体能力の高い中ボス
- **ボス敵**: 特別な能力を持つ強敵

## AI統合機能

### 1. キャラクター生成支援
- **自動生成**: 設定に基づく完全自動作成
- **部分生成**: 特定項目の AI 補完
- **バランス調整**: 能力値の適切な配分提案

### 2. ストーリー統合支援
- **関係性提案**: キャラクター間の関係案
- **背景生成**: 詳細な背景設定の創出
- **成長提案**: レベルアップ時の推奨選択

### 3. 戦闘バランス
- **難易度評価**: 敵の強さとパーティバランス
- **戦闘予測**: 想定される戦闘結果
- **調整提案**: バランス改善のための修正案

## データ構造

### TRPGCharacter基本構造
```typescript
interface TRPGCharacter {
  id: string;
  type: 'PC' | 'NPC' | 'Enemy';
  basicInfo: CharacterBasicInfo;
  abilities: AbilityScores;
  skills: Skill[];
  equipment: Equipment[];
  appearance: AppearanceInfo;
  backstory: BackstoryInfo;
  relationships: Relationship[];
}
```

### 能力値構造
```typescript
interface AbilityScores {
  strength: number;
  dexterity: number;
  constitution: number;
  intelligence: number;
  wisdom: number;
  charisma: number;
  derivedStats: DerivedStats;
}
```

### 関係性構造
```typescript
interface Relationship {
  targetId: string;
  type: RelationshipType;
  strength: number;
  description: string;
  history: RelationshipEvent[];
}
```

## UI/UX要件

### 1. タブベース管理
- **PC タブ**: プレイヤーキャラクター一覧
- **NPC タブ**: 重要 NPC 管理
- **Enemy タブ**: 敵キャラクター管理

### 2. カードビューインターフェース
- **キャラクターカード**: 概要情報の視覚的表示
- **詳細ビュー**: フルシート表示モード
- **編集ビュー**: インライン編集機能

### 3. 検索・フィルタリング
- **種別フィルタ**: PC/NPC/Enemy による絞り込み
- **レベル範囲**: 能力レベルでの絞り込み
- **関係性検索**: 特定キャラクターとの関係

## パーティ分析機能

### 1. バランス評価
- **役割カバレッジ**: 戦闘・探索・社交の役割分担
- **能力分布**: 各種能力値の偏り分析
- **推奨改善**: 不足要素の具体的提案

### 2. 視覚的分析
- **レーダーチャート**: パーティ能力の視覚化
- **比較表**: キャラクター間の能力比較
- **成長予測**: 将来的な発展予想

## インポート・エクスポート機能

### 1. データ交換
- **キャラクターシート出力**: PDF、画像形式での出力
- **データインポート**: 他ツールからのデータ取り込み
- **バックアップ**: キャラクターデータの保存・復元

### 2. 共有機能
- **プレイヤー共有**: PC データのプレイヤーへの共有
- **GM参照**: NPC/Enemy データの管理者専用表示

## エラーハンドリング

### 1. データ整合性
- **能力値制限**: ゲームシステムに準拠した上下限
- **必須項目**: 最低限必要な情報の確保
- **関係性整合**: キャラクター間関係の論理的整合性

### 2. バックアップ・復旧
- **自動保存**: 編集内容の定期的自動保存
- **バージョン履歴**: 変更履歴の保持と復元
- **競合解決**: 同時編集時の適切な処理

## テスト要件

### 1. 機能テスト
- **CRUD操作**: 作成・参照・更新・削除の正常動作
- **AI統合**: AI機能の適切な動作確認
- **パーティ分析**: バランス評価機能の精度

### 2. パフォーマンステスト
- **大量データ**: 多数キャラクター管理時の性能
- **リアルタイム更新**: 編集時の応答性
- **検索性能**: フィルタリング・検索の速度