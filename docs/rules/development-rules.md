# 開発ルール

このファイルは AIAgentTRPGGM プロジェクトの開発における重要なルールをまとめています。

## プロジェクト起動と開発環境

### 必須事項
- **必ず `./start-dev.sh` スクリプトを使用する**
  - 多重起動防止機能付き
  - PC負荷100%によるハングを防ぐため
  - 直接 `docker compose` や `pnpm run dev` を実行しない

### 起動オプション
```bash
./start-dev.sh                       # ローカル開発環境
./start-dev.sh --docker              # Docker開発環境
./start-dev.sh --docker --build      # Dockerビルド付き起動
./start-dev.sh --docker --clean      # Dockerキャッシュクリア付き起動
```

## ビルドとテスト

### 基本コマンド
```bash
pnpm build                 # 全パッケージビルド
pnpm lint                 # 全パッケージリント
pnpm test:e2e             # E2Eテスト実行
```

### テスト実行
- 特定のテストファイル実行時は該当ディレクトリに移動
- テスト名指定で絞り込み可能
- ヘッドレスモードとデバッグモードを使い分け

## コミット前の必須作業

1. **ドキュメント更新**
   - `docs/chat.md` の更新
   - `docs/tasks.md` の更新
   - `docs/tutorial.md` の更新（チュートリアル形式）

2. **品質チェック**
   - lint と typecheck の実行
   - 型エラーの完全解決

3. **新しいドキュメント追加時**
   - README にリンクと説明を追加

## ファイル分割の基準

- **800行程度**を目安にファイル分割を検討
- 読みやすさを最優先
- 単一責任の原則に従う

## 開発スタイル

### 学習プロジェクトとしての方針
- バイブコーディング学習のためのプロジェクト
- 文書と会話は日本語で実施
- TDD でコアロジック実装
- UI はリアルタイム確認を重視

### コード品質
- any 型の使用を避ける
- TypeScript の型システムを最大活用
- 適切な型定義の運用
- 未使用機能の積極的削除

## エラーハンドリング方針

### 禁止事項
- フォールバック実装の回避
- try-catch でエラーを隠蔽する実装
- ユーザーがエラー解消できない状況の作成

### 推奨事項
- ユーザーが解消できるエラーの明確な提示
- エラー解消のためのヒント提供
- 真摯なエラー対応

## セキュリティ

- **API キーのフロント開示は重大インシデント**
- セキュリティベストプラクティスの遵守
- 秘密情報のログ出力禁止