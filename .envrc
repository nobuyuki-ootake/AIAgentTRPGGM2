#!/usr/bin/env bash
# TRPGプロジェクト共通環境変数
# このファイルはGitにコミットされ、チーム間で共有されます
# APIキーなどの秘密情報は .env.local に記載してください

# プロジェクト基本設定
export NODE_ENV="development"
export PROJECT_ROOT="$(pwd)"
export PROJECT_NAME="ai-agent-trpg-gm"

# データベース設定
export DATABASE_PATH="$PROJECT_ROOT/apps/proxy-server/data/trpg.db"
export DATABASE_TYPE="sqlite"

# サーバー設定
export FRONTEND_PORT="5173"
export BACKEND_PORT="4001"
export FRONTEND_URL="http://localhost:5173"
export BACKEND_URL="http://localhost:4001"

# ログ設定
export LOG_LEVEL="debug"
export LOG_FILE="$PROJECT_ROOT/dev.log"

# 開発ツール設定
export PLAYWRIGHT_BROWSERS_PATH="$PROJECT_ROOT/node_modules/@playwright/browsers"

# TypeScript設定
export TS_NODE_PROJECT="$PROJECT_ROOT/tsconfig.json"

# 秘密情報ファイルの読み込み（存在する場合のみ）
# APIキーやその他の機密情報は .env.local に記載してください
if [[ -f ".env.local" ]]; then
  echo "🔑 Loading secrets from .env.local"
  source_env .env.local
else
  echo "⚠️  .env.local not found. Please create it with your API keys."
  echo "   Template: cp .env.local.template .env.local"
fi

# 開発者向けメッセージ
echo "🎮 TRPG AI Game Master development environment loaded"
echo "📂 Project root: $PROJECT_ROOT"
echo "🗄️  Database: $DATABASE_PATH"
echo "🌐 Frontend: $FRONTEND_URL"
echo "🔗 Backend: $BACKEND_URL"

# Node.js バージョン管理（推奨バージョンの設定）
if command -v node >/dev/null 2>&1; then
  NODE_VERSION=$(node --version)
  echo "📦 Node.js version: $NODE_VERSION"
fi

# pnpm確認
if command -v pnpm >/dev/null 2>&1; then
  echo "📦 pnpm available: $(pnpm --version)"
else
  echo "⚠️  pnpm not installed. Please install: npm install -g pnpm"
fi